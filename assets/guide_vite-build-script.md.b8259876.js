import{_ as s,c as n,o as a,d as p}from"./app.e81c7875.js";var l="/images/11663469060hd.jpg";const A=JSON.parse('{"title":"Vite\u591A\u73AF\u5883\u6784\u5EFA\u547D\u4EE4\u7B80\u5316","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u80CC\u666F","slug":"\u80CC\u666F"},{"level":2,"title":"\u89E3\u51B3\u65B9\u6848","slug":"\u89E3\u51B3\u65B9\u6848"},{"level":3,"title":"script\u73AF\u5883\u53D8\u91CF\u63D0\u53D6","slug":"script\u73AF\u5883\u53D8\u91CF\u63D0\u53D6"},{"level":3,"title":"npm-run-all\u7B80\u5316\u6267\u884C\u811A\u672C","slug":"npm-run-all\u7B80\u5316\u6267\u884C\u811A\u672C"},{"level":3,"title":"\u53C2\u8003\u8D44\u6599","slug":"\u53C2\u8003\u8D44\u6599"}],"relativePath":"guide/vite-build-script.md","lastUpdated":null}'),o={name:"guide/vite-build-script.md"},e=p('<h1 id="vite\u591A\u73AF\u5883\u6784\u5EFA\u547D\u4EE4\u7B80\u5316" tabindex="-1">Vite\u591A\u73AF\u5883\u6784\u5EFA\u547D\u4EE4\u7B80\u5316 <a class="header-anchor" href="#vite\u591A\u73AF\u5883\u6784\u5EFA\u547D\u4EE4\u7B80\u5316" aria-hidden="true">#</a></h1><p><img src="'+l+`" alt="An image" data-fancybox="gallery"></p><h2 id="\u80CC\u666F" tabindex="-1">\u80CC\u666F <a class="header-anchor" href="#\u80CC\u666F" aria-hidden="true">#</a></h2><p>\u5B9E\u9645\u9879\u76EE\u9700\u8981\u6784\u5EFA\u7684\u73AF\u5883\u4E0D\u4EC5\u4EC5\u6709<code>\u6D4B\u8BD5\u73AF\u5883</code>\u548C<code>\u751F\u4EA7\u73AF\u5883</code>\uFF0C\u53EF\u80FD\u5305\u542B\u66F4\u591A\u7684\u73AF\u5883\uFF1A<code>Demo\u73AF\u5883</code>,<code>Verify\u73AF\u5883</code>\uFF0C<code>\u9884\u53D1\u5E03\u73AF\u5883</code>\u7B49\u3002\u6B63\u5E38\u64CD\u4F5C\u5C31\u662F\u5728<code>package.json</code>\u4E2D\u65B0\u589E\u6784\u5EFA\u547D\u4EE4\u3002</p><p>\u6BD4\u5982\u65B0\u589E<code>Demo\u73AF\u5883</code>\u6784\u5EFA\u547D\u4EE4\uFF1A</p><div class="language-json"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:script \u989D\u5916\u7684\u64CD\u4F5C\u811A\u672C</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cross-env NODE_ENV=production vite build &amp;&amp; npm run build:script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cross-env NODE_ENV=test vite build --mode test &amp;&amp; &amp;&amp; npm run build:script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:demo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cross-env NODE_ENV=demo vite build --mode demo &amp;&amp; &amp;&amp; npm run build:script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u5F53\u73AF\u5883\u8D85\u8FC7\u4E00\u5B9A\u7684\u6570\u91CF\u65F6\u5019\uFF0C<code>package.json</code>\u4E2D\u7684<code>&quot;script&quot;</code>\u4F1A\u53D8\u5F97\u76F8\u5F53\u5197\u957F\u548C\u590D\u6742\u3002</p><h2 id="\u89E3\u51B3\u65B9\u6848" tabindex="-1">\u89E3\u51B3\u65B9\u6848 <a class="header-anchor" href="#\u89E3\u51B3\u65B9\u6848" aria-hidden="true">#</a></h2><p>\u9488\u5BF9\u4E0A\u9762\u60C5\u666F\uFF0C\u6211\u4EEC\u9700\u8981\u4F18\u5316<code>package.json-&gt;script</code>\u4E2D\u7684\u89C4\u5219\u3002</p><ul><li>\u4F18\u5316<code>script</code>\u7684\u73AF\u5883\u53D8\u91CF\uFF1A<code>cross-env</code>\u7684<code>NODE_ENV</code>\u548C<code>vite build</code>\u7684<code>mode</code>\u662F\u5426\u516C\u7528\u3002</li><li>\u591A\u4E2A\u811A\u672C\u6267\u884C\u4F18\u5316\uFF1A\u901A\u8FC7<a href="https://github.com/mysticatea/npm-run-all" target="_blank" rel="noopener noreferrer">npm-run-all</a>\u8FDB\u884C\u4F18\u5316\u3002</li></ul><h3 id="script\u73AF\u5883\u53D8\u91CF\u63D0\u53D6" tabindex="-1"><code>script</code>\u73AF\u5883\u53D8\u91CF\u63D0\u53D6 <a class="header-anchor" href="#script\u73AF\u5883\u53D8\u91CF\u63D0\u53D6" aria-hidden="true">#</a></h3><p>\u5728<a href="https://cn.vitejs.dev/" target="_blank" rel="noopener noreferrer">Vite</a>\u6784\u5EFA\u4E2D\u901A\u8FC7<code>mode</code>\u66FF\u6362<code>cross-env</code>\u7684<code>NODE_ENV</code>\u7684\u73AF\u5883\u53D8\u91CF\u3002</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">build:test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm run update-pack &amp;&amp; vite build --mode test &amp;&amp; npm run build:script</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>\u5728<code>vite.config.js</code>\u4E2D\uFF0C\u8BFB\u53D6\u76F8\u5173\u53C2\u6570\u4FE1\u606F\u5E76\u4E14\u6CE8\u5165\u6307\u5B9A\u7684\u73AF\u5883\u53D8\u91CF\uFF0C\u76EE\u524D\u901A\u8FC7<a href="https://github.com/ElMassimo/vite-plugin-environment" target="_blank" rel="noopener noreferrer">vite-plugin-environment</a>\u63D2\u4EF6\u5904\u7406\u3002</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">defineConfig</span><span style="color:#A6ACCD;">((</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">commang</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> mode</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">     reutrn {</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#F07178;">plugins</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#82AAFF;">EnvironmentPlugin</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#F07178;">NODE_ENV</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> mode</span></span>
<span class="line"><span style="color:#A6ACCD;">         </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">   })</span></span>
<span class="line"></span></code></pre></div><h3 id="npm-run-all\u7B80\u5316\u6267\u884C\u811A\u672C" tabindex="-1"><a href="https://github.com/mysticatea/npm-run-all" target="_blank" rel="noopener noreferrer">npm-run-all</a>\u7B80\u5316\u6267\u884C\u811A\u672C <a class="header-anchor" href="#npm-run-all\u7B80\u5316\u6267\u884C\u811A\u672C" aria-hidden="true">#</a></h3><div class="language-json"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:update-pack</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pnpm install || yarn install || npm install</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm run update-pack &amp;&amp; vite build --mode test &amp;&amp; npm run build:script</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// \u7B80\u5316\u540E</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">     ...</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:update-pack</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pnpm install || yarn install || npm install</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm-run-all update-pack &amp;&amp; vite build --mode test &amp;&amp; build:script</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u8FDB\u4E00\u6B65\u8FDB\u5316\u548C\u62C6\u5206<code>script</code>,\u4ECE\u547D\u4EE4\u884C\u53C2\u6570\u6CE8\u5165\u3002</p><div class="language-json"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">           ...</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:update-pack</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pnpm install || yarn install || npm install</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:vite-build</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vite build</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm-run-all update-pack &amp;&amp; </span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#C3E88D;">build:vitebuild --mode {1} </span><span style="color:#A6ACCD;">\\&quot;</span><span style="color:#C3E88D;"> &amp;&amp; build:script --</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u6267\u884C\u7684\u811A\u672C\uFF1A</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">// \u8C03\u6574\u524D \u9700\u8981\u81EA\u5DF1\u8865\u5145script\u4E2D\u4E0D\u540C\u73AF\u5883\u7684\u6784\u5EFA\u547D\u4EE4</span></span>
<span class="line"><span style="color:#A6ACCD;">pnpm</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">yarn</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">npm run build:test</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">// \u8C03\u6574\u524D \u6839\u636E\u6784\u5EFA\u573A\u666F\uFF0C\u4ECE\u547D\u4EE4\u884C\u8FDB\u884C\u53C2\u6570\u6CE8\u5165\uFF08ps:\u6784\u5EFA\u73AF\u5883\u76F8\u5BF9\u590D\u6742\u7684\u9879\u76EE\uFF0C\u7B80\u6613</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">\u4E00\u5B9A</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">\u8865\u5145README.md\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">pnpm</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">yarn</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">npm run build test</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">\u6784\u5EFA\u7684\u73AF\u5883</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="\u53C2\u8003\u8D44\u6599" tabindex="-1">\u53C2\u8003\u8D44\u6599 <a class="header-anchor" href="#\u53C2\u8003\u8D44\u6599" aria-hidden="true">#</a></h3><ul><li><a href="https://cn.vitejs.dev/" target="_blank" rel="noopener noreferrer">Vite</a></li><li><a href="https://github.com/ElMassimo/vite-plugin-environment" target="_blank" rel="noopener noreferrer">vite-plugin-environment</a></li><li><a href="https://github.com/mysticatea/npm-run-all" target="_blank" rel="noopener noreferrer">npm-run-all</a></li></ul>`,23),t=[e];function c(r,D,F,i,y,C){return a(),n("div",null,t)}var u=s(o,[["render",c]]);export{A as __pageData,u as default};
