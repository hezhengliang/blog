import{_ as s,c as n,o as a,d as l}from"./app.536dd677.js";const C=JSON.parse('{"title":"Python\u5DE5\u5177","description":"","frontmatter":{},"headers":[{"level":2,"title":"pysmb\u5B9E\u73B0\u6587\u4EF6\u5171\u4EAB","slug":"pysmb\u5B9E\u73B0\u6587\u4EF6\u5171\u4EAB"}],"relativePath":"guide/python-extends.md","lastUpdated":null}'),p={name:"guide/python-extends.md"},e=l(`<h1 id="python\u5DE5\u5177" tabindex="-1">Python\u5DE5\u5177 <a class="header-anchor" href="#python\u5DE5\u5177" aria-hidden="true">#</a></h1><h2 id="pysmb\u5B9E\u73B0\u6587\u4EF6\u5171\u4EAB" tabindex="-1">pysmb\u5B9E\u73B0\u6587\u4EF6\u5171\u4EAB <a class="header-anchor" href="#pysmb\u5B9E\u73B0\u6587\u4EF6\u5171\u4EAB" aria-hidden="true">#</a></h2><ul><li>pip\u8FDB\u884Cpysmb\u5B89\u88C5</li></ul><div class="language-sh"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">  pip install pysmb</span></span>
<span class="line"></span></code></pre></div><ul><li><p>pysmb\u8BE6\u7EC6\u529F\u80FD\u5C5E\u6027\u8BF7\u53C2\u7167<a href="https://pysmb.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">\u5B98\u65B9\u6587\u6863</a></p></li><li><p>\u5B9E\u4F8B\u4EE3\u7801\u5982\u4E0B</p></li></ul><div class="language-python"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> smb</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">SMBConnection </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> SMBConnection</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> socket</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">():</span></span>
<span class="line"><span style="color:#A6ACCD;">    server_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> socket</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getfqdn</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">address_ip</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># server_name should match the remote machine name, or else the connection will be rejected</span></span>
<span class="line"><span style="color:#A6ACCD;">    conn </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SMBConnection</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">username</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span></span>
<span class="line"><span style="color:#82AAFF;">                password</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span></span>
<span class="line"><span style="color:#82AAFF;">                </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">func_handle</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span></span>
<span class="line"><span style="color:#82AAFF;">                server_name</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">                domain</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">                </span><span style="color:#A6ACCD;">use_ntlm_v2</span><span style="color:#89DDFF;">=True,</span></span>
<span class="line"><span style="color:#82AAFF;">                </span><span style="color:#A6ACCD;">sign_options</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">SMBConnection</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">SIGN_WHEN_SUPPORTED</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">                </span><span style="color:#A6ACCD;">is_direct_tcp</span><span style="color:#89DDFF;">=True)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># tcp port: 445 || NetBIOS port: 139</span></span>
<span class="line"><span style="color:#A6ACCD;">    connected </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> conn</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">connect</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">server_name</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">445</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># getAttributes(service_name, path, timeout=30)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># list share files</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># listPath(service_name, path, search=65591, pattern=&#39;*&#39;, timeout=30)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#file_obj = tempfile.NamedTemporaryFile()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#file_attributes, filesize = conn.retrieveFile(&#39;smbtest&#39;, &#39;/rfc1001.txt&#39;, file_obj)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">__name__</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span></code></pre></div>`,6),o=[e];function t(c,r,y,i,F,D){return a(),n("div",null,o)}var _=s(p,[["render",t]]);export{C as __pageData,_ as default};
